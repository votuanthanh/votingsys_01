{"version":3,"sources":["vote.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"vote.js","sourcesContent":["$(document).ready(function(){\n\n    // Plugin Search Row\n    $.fn.searchRow = function(options) {\n        // These are the defaults.\n        var defaults = {\n            jo: $('.model-show-details').find('tbody tr').not('.header, :last-child'),\n            warpper: '.model-show-details'\n        };\n\n        var options = $.extend(defaults, options);\n\n        var inputText = this[0];\n\n        $(options.warpper).on('keyup', inputText, function (e) {\n            var $this = e.target;\n\n            if (inputText === $this) {\n                //split the current value of searchInput\n                var data = $this.value.split(\" \");\n\n                if ($this.value == \"\") {\n                    options.jo.show();\n                    return;\n                }\n\n                //hide all the rows\n                options.jo.hide();\n\n                //Recusively filter the jquery object to get results.\n                options.jo.filter(function (i, v) {\n                    var $t = $(this);\n                    for (var d = 0; d < data.length; ++d) {\n                        if ($t.is(\":contains('\" + data[d] + \"')\")) {\n                            return true;\n                        }\n                    }\n                    return false;\n                })\n                //show the rows that match.\n                .show();\n            }\n        });\n    }\n\n    $('.search-row-detail').searchRow();\n\n    // Set position thead\n    $('#timeline').scroll(function () {\n        var $boxTimeline = $('#timeline');\n        var scrollTop = $boxTimeline.scrollTop();\n\n        $('.fixed-header').css('top', scrollTop);\n\n        if ($boxTimeline.prop('scrollHeight') > $boxTimeline.height()) {\n            $('.td-fixed-check').css('bottom', -scrollTop);\n        }\n    });\n\n    $('.btn-vote-style').on('shown.bs.tab', function (e) {\n        var contentTab = $(e.target).prop('href');\n\n        if (contentTab.indexOf('timeline') !== -1) {\n            createWaypointThead();\n\n            if ($('#timeline').prop('scrollHeight') > $('#timeline').height()) {\n                createFixedTfoot();\n            }\n\n            return;\n        }\n\n        destroyDom();\n    });\n\n    $.ajaxSetup({\n        headers: {\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n        }\n    });\n\n    $('.loader').hide();\n\n    $.extend({\n        xResponse: function(url, data, messageError) {\n            // local var\n            var theResponse = null;\n            // jQuery ajax\n            $.ajax({\n                url: url,\n                type: 'POST',\n                data: data,\n                dataType: \"json\",\n                async: false,\n\n                beforeSend: function () {\n                    $('.loader').show();\n                },\n\n                success: function(respText) {\n                    theResponse = respText.status;\n                },\n\n                complete: function () {\n                    $('.loader').hide();\n                },\n\n                error: function () {\n                    showMessage(messageError);\n                    $('.loader').hide();\n                }\n            });\n            // Return the response text\n            return theResponse;\n        }\n    });\n\n    $('#timeline').on('click', '.js-edit-vote', function (e) {\n        var $this = $(this);\n        var data = $this.closest('.inline-edit').data('edit-voted');\n        var $tr = $this.closest('tr');\n        var nameVote = $tr.find('.name-voter').text();\n        var emailVote = $tr.find('.email-voter').text();\n\n        $tr.hide();\n\n        $('.js-voter-box').not($tr).show();\n\n        $('.tf-check-option').addClass('hide');\n\n        $('.row-temp').remove();\n\n        // set data global for button save\n        data.email = emailVote;\n        $('#data-voter').data('dataRequest', data);\n\n        var $optionChoose = $('.tf-check-option tr').clone().addClass('row-temp');\n\n        // Remove class button action edit and cancel\n        $optionChoose.get(1).classList.remove('hide');\n\n        // Show input text to edit information of voter or hide input text if authentication was\n        if (data.vote_id || data.user_id) {\n            $optionChoose.find('.td-name-temp').html(nameVote);\n            $optionChoose.find('.td-email-temp').html(emailVote);\n        } else {\n            $optionChoose.find('input[name=name]').val(nameVote).removeClass('hide');\n            $optionChoose.find('input[name=email]').val(emailVote).removeClass('hide');\n        }\n\n        // Show option to edit\n        $optionChoose.find('*').removeAttr('onclick id');\n        var $optionEdit = $optionChoose.find('.opsep input')\n            .prop('checked', false)\n            .attr({'name': 'optionedit[]', 'class': 'data-edit-option'});\n\n        $tr.find('.opsep').each(function (index, value) {\n            if ($(this).hasClass('pop')) {\n                $optionEdit.eq(index).prop('checked', true);\n            }\n        });\n\n        $('.td-fixed-check').remove();\n\n        $(this).closest('tr').after($optionChoose);\n    });\n\n    $('#timeline').on('click', '.save-edit-vote', function () {\n        var $this = $(this);\n        var object = $('.js-data-validate').data();\n        var name = $('.input-name').val().trim();\n        var email = $('.input-email').val().trim();\n        var dataRequest = $('#data-voter').data('dataRequest');\n\n        // Validate when dom show errror if exists\n        if ($('.tr-input.row-temp span').removeClass('hide').length > 0) {\n            var testEmail = /^[A-Z0-9._%+-]+@([A-Z0-9-]+\\.)+[A-Z]{2,4}$/i;\n\n            if (name && name.length > 100) {\n                $('.js-show-error-name').text(object.voteLimitName);\n\n                return false;\n            }\n\n            if (email && !testEmail.test(email)) {\n                $('.js-show-error-email').text(object.messageValidateEmail);\n\n                return false;\n            }\n\n            if (object.isRequiredNameAndEmail && name == '' && email == '') {\n                $('.js-show-error-name').text(object.messageRequiredNameAndEmail);\n\n                return false;\n            }\n\n            if (object.isRequiredNameAndEmail || object.isRequiredEmail) {\n\n                if (email == '') {\n                    $('.js-show-error-email').text(object.messageRequiredEmail);\n\n                    return false;\n                }\n\n                if (object.isAccecptTypeMail && !checkAccecptTypeEmail(object.typeEmail.trim(), email)) {\n                    $('.js-show-error-email').text(object.messageRequiredTypeEmail);\n\n                    return false;\n                }\n\n                // Check email exist if propety require email\n                if (object.isNotSameEmail\n                    && $.xResponse(\n                        object.urlCheckExistEmail,\n                        {pollId: object.idPoll, emailVote: email, emailIgnore: dataRequest.email}\n                    )\n                ) {\n                    $('.js-show-error-email').text(object.messageEmailExists);\n\n                    return false;\n                }\n\n                $('.js-show-error-email').empty();\n            }\n\n            if (object.isRequiredNameAndEmail || object.isRequiredName) {\n                if (name == '') {\n                    $('.js-show-error-name').text(object.messageRequiredName);\n\n                    return false;\n                }\n\n                if (name.length > 100) {\n                    $('.js-show-error-name').text(object.voteLimitName);\n\n                    return false;\n                }\n\n                $('.js-show-error-name').empty();\n            }\n        }\n\n        // Set data to request to edit vote of option by voter\n        var dataRequest = $('#data-voter').data('dataRequest');\n        var urlRequest = $this.data('url-edit');\n\n        if (typeof name != 'undefined' && typeof email != 'undefined') {\n            dataRequest.name = name;\n            dataRequest.email = email;\n        }\n\n        dataRequest.poll_id = $this.parent().data('poll-id');\n        dataRequest.option = $('.data-edit-option:checked').map(function () {\n            return $(this).val();\n        })\n        .get();\n\n        // Request input option when voted\n        if (dataRequest.option.length === 0) {\n            $this.siblings('.mess-option').removeClass('hide');\n\n            return false;\n        }\n\n        $this.siblings('.mess-option').addClass('hide');\n\n        $.ajax({\n            url: urlRequest,\n            type: 'POST',\n            data: dataRequest,\n            dataType: 'json',\n            async: false,\n\n            beforeSend: function () {\n                $('.loader').show();\n            },\n\n            success: function(respText) {\n                if (!respText.status) {\n                    $this.siblings('.mess-error').removeClass('hide');\n                } else {\n                    $this.siblings('.mess-error').addClass('hide');\n                }\n            },\n\n            complete: function () {\n                $('.loader').hide();\n            },\n        });\n    });\n\n    $('#timeline').on('click', '.cancel-edit-vote', function () {\n        $('.row-temp').remove();\n        $('.td-fixed-check').remove();\n\n        $('.js-voter-box:hidden').show();\n        $('.tf-check-option').removeClass('hide');\n\n        if ($('#timeline').prop('scrollHeight') > $('#timeline').height()) {\n            createFixedTfoot();\n        }\n    });\n\n    $('#timeline').on('click', '.js-delete-vote', function () {\n        // Set data to request to delete vote of option by voter\n        var dataRequest = $(this).closest('.inline-edit').data('edit-voted');\n        var dataVoter = $(this).data();\n\n        dataRequest._method = 'DELETE';\n        dataRequest.option = dataVoter.option;\n        dataRequest.poll_id = dataVoter.pollId;\n\n        swal({\n            title: dataVoter.message,\n            type: \"info\",\n            showCancelButton: true,\n            confirmButtonColor: \"#DD6B55\",\n            confirmButtonText: \"Yes\",\n            closeOnConfirm: true\n        }, function () {\n            $('.loader').show();\n            $.ajax({\n                url: dataVoter.urlDelete,\n                type: 'DELETE',\n                data: dataRequest,\n                dataType: 'json',\n                async: false,\n                success: function(respText) {\n                    if (!respText.status) {\n                        alert(respText.message);\n                    }\n                },\n\n                complete: function () {\n                    $('.loader').hide();\n                },\n            });\n        });\n    });\n\n    $(window).resize(function () {\n        if ($('#timeline').is(':visible')) {\n            destroyDom();\n            createWaypointThead();\n\n            if ($('#timeline').prop('scrollHeight') > $('#timeline').height()) {\n                createFixedTfoot();\n            }\n        }\n    });\n\n    $('.btn-vote').prop('disabled', true);\n\n    $('.btn-vote').on('click', function() {\n        var testEmail = /^[A-Z0-9._%+-]+@([A-Z0-9-]+\\.)+[A-Z]{2,4}$/i;\n        divChangeAmount = $(this).parent();\n        var url = divChangeAmount.data('url');\n        var idPoll = divChangeAmount.data('idPoll');\n        var urlCheckExistEmail = divChangeAmount.data('urlCheckExistEmail');\n        var isRequiredEmail = divChangeAmount.data('isRequiredEmail');\n        var isRequiredName = divChangeAmount.data('isRequiredName');\n        var isRequiredNameAndEmail = divChangeAmount.data('isRequiredNameAndEmail');\n        var isNotTheSameEmail = divChangeAmount.data('isNotSameEmail');\n        var nameVote = $('.nameVote').val();\n        var emailVote = $('.emailVote').val();\n        var message = '';\n        var data = divChangeAmount.data();\n\n        if (isRequiredEmail == 1) {\n            if (emailVote.trim() != '') {\n                if (testEmail.test(emailVote)) {\n                    if (nameVote.trim().length >= 100) {\n                        divChangeAmount = $(this).parent();\n                        message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                            + ' ' + divChangeAmount.data('voteLimitName');\n                        $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                        $('.nameVote').addClass('error');\n\n                        if ($('.emailVote').hasClass('error')) {\n                            $('.emailVote').removeClass('error');\n                        }\n                    } else {\n                        // Check pass type email of setting\n                        if (data.isAccecptTypeMail) {\n                            if (!checkAccecptTypeEmail(data.typeEmail.trim(), emailVote.trim())) {\n                                showMessage(data.messageRequiredTypeEmail);\n\n                                return;\n                            }\n                        }\n\n                        // Check email exist if propety require email\n                        if (isNotTheSameEmail) {\n                            var status = $.xResponse(urlCheckExistEmail, {pollId: idPoll, emailVote: emailVote});\n\n                            if (status) {\n                                showMessage(data.messageEmailExists, data.messageErrorOccurs);\n\n                                return;\n                            }\n                        }\n\n                        this.disabled = true;\n                        removeClassError();\n                        $('.message-validation').removeClass('alert alert-warning alert-poll-set-ip').html('');\n                        $('#form-vote').submit();\n                        $('.loader').show();\n                    }\n                } else {\n                    divChangeAmount = $(this).parent();\n                    message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                        + ' ' +  divChangeAmount.data('messageValidateEmail');\n                    $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                    $('.emailVote').addClass('error');\n\n                    if ($('.nameVote').hasClass('error')) {\n                        $('.nameVote').removeClass('error');\n                    }\n                }\n            } else {\n                divChangeAmount = $(this).parent();\n                message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                    + ' ' + divChangeAmount.data('messageRequiredEmail');\n                $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                $('.emailVote').addClass('error');\n\n                if ($('.nameVote').hasClass('error')) {\n                    $('.nameVote').removeClass('error');\n                }\n            }\n        } else if (isRequiredName == 1) {\n            if (nameVote.trim() != '') {\n                if (nameVote.trim().length < 100) {\n                    if (emailVote.trim() != '') {\n                        if (testEmail.test(emailVote)) {\n                            this.disabled = true;\n                            removeClassError();\n                            $('.message-validation').removeClass('alert alert-warning alert-poll-set-ip').html('');\n                            $('#form-vote').submit();\n                            $('.loader').show();\n                        } else {\n                            divChangeAmount = $(this).parent();\n                            message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                                + ' ' +  divChangeAmount.data('messageValidateEmail');\n                            $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                            $('.emailVote').addClass('error');\n\n                            if ($('.nameVote').hasClass('error')) {\n                                $('.nameVote').removeClass('error');\n                            }\n                        }\n                    } else {\n                        this.disabled = true;\n                        removeClassError();\n                        $('.message-validation').removeClass('alert alert-warning alert-poll-set-ip').html('');\n                        $('#form-vote').submit();\n                        $('.loader').show();\n                    }\n                } else {\n                    divChangeAmount = $(this).parent();\n                    message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                        + ' ' + divChangeAmount.data('voteLimitName');\n                    $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                    $('.nameVote').addClass('error');\n\n                    if ($('.emailVote').hasClass('error')) {\n                        $('.emailVote').removeClass('error');\n                    }\n                }\n            } else {\n                divChangeAmount = $(this).parent();\n                message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                    + ' ' + divChangeAmount.data('messageRequiredName');\n                $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                $('.nameVote').addClass('error');\n\n                if ($('.emailVote').hasClass('error')) {\n                    $('.emailVote').removeClass('error');\n                }\n            }\n        } else if (isRequiredNameAndEmail == 1) {\n            if (nameVote.trim() != '' && nameVote.trim().length < 100) {\n                if (emailVote.trim() == '') {\n                    divChangeAmount = $(this).parent();\n                    message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                        + ' ' + divChangeAmount.data('messageRequiredEmail');\n                    $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                    $('.emailVote').addClass('error');\n\n                    if ($('.nameVote').hasClass('error')) {\n                        $('.nameVote').removeClass('error');\n                    }\n                } else {\n                    if (testEmail.test(emailVote)) {\n                        // Check pass type email of setting\n                        if (data.isAccecptTypeMail) {\n                            if (!checkAccecptTypeEmail(data.typeEmail, emailVote)) {\n                                showMessage(data.messageRequiredTypeEmail);\n\n                                return;\n                            }\n                        }\n\n                        // Check email exist if propety require email\n                        if (isNotTheSameEmail) {\n                            var status = $.xResponse(urlCheckExistEmail, {pollId: idPoll, emailVote: emailVote});\n\n                            if (status) {\n                                showMessage(data.messageEmailExists, data.messageErrorOccurs);\n\n                                return;\n                            }\n                        }\n\n                        this.disabled = true;\n                        removeClassError();\n                        $('.message-validation').removeClass('alert alert-warning alert-poll-set-ip').html('');\n                        $('#form-vote').submit();\n                        $('.loader').show();\n                    } else {\n                        divChangeAmount = $(this).parent();\n                        message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                            + ' ' +  divChangeAmount.data('messageValidateEmail');\n                        $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                        $('.emailVote').addClass('error');\n\n                        if ($('.nameVote').hasClass('error')) {\n                            $('.nameVote').removeClass('error');\n                        }\n                    }\n                }\n            } else {\n                if (nameVote.trim() == '') {\n                    if (emailVote.trim() == '') {\n                        divChangeAmount = $(this).parent();\n                        message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                            + ' ' + divChangeAmount.data('messageRequiredNameAndEmail');\n                        $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                        $('.nameVote').addClass('error');\n                        $('.emailVote').addClass('error');\n                    } else {\n                        divChangeAmount = $(this).parent();\n                        message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                            + ' ' + divChangeAmount.data('messageRequiredName');\n                        $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                        $('.nameVote').addClass('error');\n\n                        if ($('.emailVote').hasClass('error')) {\n                            $('.emailVote').removeClass('error');\n                        }\n                    }\n                } else if (nameVote.trim().length >= 100) {\n                    divChangeAmount = $(this).parent();\n                    message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                        + ' ' + divChangeAmount.data('voteLimitName');\n                    $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                    $('.nameVote').addClass('error');\n\n                    if ($('.emailVote').hasClass('error')) {\n                        $('.emailVote').removeClass('error');\n                    }\n                }\n            }\n        } else {\n            var isPassValidate = false;\n\n            if (emailVote.trim() != '') {\n                if (testEmail.test(emailVote)) {\n                    isPassValidate = true;\n                } else {\n                    divChangeAmount = $(this).parent();\n                    message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                        + ' ' +  divChangeAmount.data('messageValidateEmail');\n                    $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                    $('.emailVote').addClass('error');\n\n                    if ($('.nameVote').hasClass('error')) {\n                        $('.nameVote').removeClass('error');\n                    }\n                }\n            } else {\n                isPassValidate = true;\n            }\n\n            if (nameVote.trim().length >= 100) {\n                divChangeAmount = $(this).parent();\n                message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n                    + ' ' + divChangeAmount.data('voteLimitName');\n                $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n                $('.nameVote').addClass('error');\n\n                if ($('.emailVote').hasClass('error')) {\n                    $('.emailVote').removeClass('error');\n                }\n                isPassValidate = false;\n            }\n\n            if (isPassValidate) {\n                // Check email exist if propety require email\n                if (isNotTheSameEmail) {\n                    var status = $.xResponse(urlCheckExistEmail, {pollId: idPoll, emailVote: emailVote});\n\n                    if (status) {\n                        showMessage(data.messageEmailExists, data.messageErrorOccurs);\n\n                        return;\n                    }\n                }\n                this.disabled = true;\n                removeClassError();\n                $('.message-validation').removeClass('alert alert-warning alert-poll-set-ip').html('');\n                $('#form-vote').submit();\n                $('.loader').show();\n            }\n        }\n    });\n\n    function removeClassError()\n    {\n        if ($('.emailVote').hasClass('error')) {\n            $('.emailVote').removeClass('error');\n        }\n\n        if ($('.nameVote').hasClass('error')) {\n            $('.nameVote').removeClass('error');\n        }\n    }\n\n    function showMessage(message)\n    {\n        var message = \"<span class='glyphicon glyphicon-warning-sign'></span>\"\n            + ' ' +  message;\n        $('.message-validation').addClass('alert alert-warning alert-poll-set-ip').html(message);\n        $('.emailVote').addClass('error');\n\n        if ($('.nameVote').hasClass('error')) {\n            $('.nameVote').removeClass('error');\n        }\n    }\n\n    function checkAccecptTypeEmail(typeEmail, email)\n    {\n        var type = email.substr(email.indexOf('@') + 1).trim();\n        var typeEmail = typeEmail.split(',');\n        var sameExtensionEmail = false;\n\n        if (type.length && typeEmail.length) {\n            typeEmail.some(function (item) {\n                return sameExtensionEmail = (item.trim() === type);\n            });\n        }\n\n        return sameExtensionEmail;\n    }\n\n    $('.btn-edit-submit').on('click', function () {\n        var isEmpty = false;\n        $('input[id^=optionText]').each(function () {\n            if ($(this).val() == '') {\n                return isEmpty = true;\n            }\n        });\n\n        if (isEmpty) {\n            var messageEmpty = $('.vote-style').data('option').message.option_required;\n            $('.btn-edit-submit').prop('disabled', true);\n            $('.error_option').addClass('has-error').html('<span id=\"title-error\" class=\"help-block\">' + messageEmpty + '</span>');\n\n            return;\n        }\n\n        $('.btn-edit-submit').prop('disabled', false);\n        $('#edit-voted-content').submit();\n    });\n\n    $('#message-flash').fadeIn().delay(3000).fadeOut();\n\n    $('#frame-upload-image-edit').on('hidden.bs.modal', function () {\n        $('body').attr('class', 'modal-open');\n    });\n\n    $('.edit-each-option').on('click', function () {\n        var dataClient = $(this).closest('.vote-style').data('option');\n        var dataViewOption = dataClient.view.option;\n        var data = {optionText: {}};\n\n        $('.content-option-choose').each(function (index) {\n            var idOption = $('input[name=\"option[]\"]').eq(index).val();\n            data.optionText[idOption] = $(this).text();\n        });\n\n        $('.poll-option').html('')\n        createOption(dataViewOption, '', data);\n\n        var frnCheckTheSame = ['checkOptionSame(this, \\'', dataClient.message.option_duplicate, '\\')'].join('');\n        $('#frame-edit-poll').find('.btn-remove-option').remove();\n        $('#frame-edit-poll').find('input[name^=optionText]')\n            .removeAttr('onfocus onclick')\n            .attr({\n                onblur: frnCheckTheSame,\n                onkeyup: frnCheckTheSame\n            });\n\n        pickDateOption();\n\n        $('.li-parent-vote').find('.image-option-choose').each(function (index) {\n            var srcImage = $(this).prop('src');\n            if (srcImage.indexOf('default-thumb.gif') == -1 ) {\n                $('#frame-edit-poll').find('.render-img').eq(index).attr('src', srcImage);\n                $('#frame-edit-poll').find('.box-media-image').eq(index).css('display', 'inline-block');\n            }\n        });\n\n        $('#frame-edit-poll').modal('show');\n    });\n\n    $('#horizontal').on('click', '.hidden-counter', function () {\n        var url = $(this).data('url-modal-voter');\n\n        $.ajax({\n            url: url,\n            method: 'GET',\n            dataType: 'json',\n            success: function (data) {\n                if (data.status) {\n                    $('#result-voters').html(data.voters);\n                    $('.loader').hide();\n                }\n            },\n\n            beforeSend: function () {\n                $('.loader').show();\n            },\n\n            complete: function () {\n                $('.loader').hide();\n\n                $('#voters-modal').modal('show');\n\n                $('#voters-modal').off('keyup');\n                $('.search-voters-row').searchRow({\n                    jo: $('.voters-row'),\n                    warpper: '#voters-modal'\n                });\n            },\n        });\n    });\n\n});\n\nvar jqAddNewImageOption11 = new jqAddImageOption({\n    wrapperPoll: '.poll-option',\n    parentOption: '.form-group',\n    thumbImageOption: '.render-img',\n    btnChooseImage: '.upload-photo',\n    frImage: \"#frame-upload-image-edit\",\n    frUploadFile: '.photo-tb-upload-edit',\n    frPreImage: '.img-pre-option-edit',\n    frAddImgLink: '.add-image-by-link-edit',\n    frInputText: '.photo-tb-url-txt-edit',\n    frDelPhoto: '.photo-tb-del-edit',\n    frConfirmYes: '.btn-yes-edit',\n    frInputFileTemp: '.fileImgTempEdit',\n    frContentError : '.error-win-img-edit',\n    messages: 'div[data-option]',\n});\n\n/**\n * Add New Option\n */\nvar addNewOption = function () {\n    this.init = function() {\n        this.cacheDom();\n        this.bindEvent();\n    }\n\n    this.cacheDom = function () {\n        // DOM to process image of option\n        this.$preview = $('.render-img');\n        this.$btnFileImg = $('.btn-file-img');\n        this.$deleteImg = $('.deleteImg');\n        this.$parentThumb = $('.box-media-image');\n\n        // DOM to process option text\n        this.$newOption = $('.new-option');\n        this.$liParent = $('.parent-vote');\n        this.$inputTextOption = $('.text-new-option');\n        this.$allOption = $('input[id^=horizontal]');\n\n        this.$contentOption = $('.option-name').find('span');\n\n        // DOM button to vote\n        this.$btnVote = $('.btn-vote');\n        this.$boxVote = $('#voting_wizard');\n\n        // DOM warpper vote\n        this.$voteImageWrapper = $('.vote-preview-wrapper');\n\n        // DOM to scrollTop div\n        this.$horizontalWrapper = $('.horizontal-overflow');\n\n        // Check option that choose radio or checkbox\n        this.isRadio = this.$newOption.is(':radio');\n\n        // DOM to show message validation\n        this.$showError = $('#error_option');\n        this.messageValidate = this.$showError.data('message');\n\n        // DOM of datepicker\n        this.$datePicker = $('.date-time-picker');\n        this.$pickDate = $('.pick-date');\n    }\n\n    this.bindEvent = function () {\n        this.$showError.hide();\n        this.$preview.on('load', this.loadPreImage.bind(this));\n        this.$inputTextOption.on('input', this.addText.bind(this));\n        this.$boxVote.on('click', '.new-option', this.chooseOption.bind(this));\n        this.$boxVote.on('click', '.parent-vote' ,this.chooseOptionWithLi.bind(this));\n        this.$pickDate.on('click', this.getTextDatePicker.bind(this));\n        this.$datePicker.on('dp.hide', this.addTextDate.bind(this));\n    }\n\n    this.loadPreImage = function () {\n        this.$deleteImg.show();\n        this.$voteImageWrapper.css('border', '1px solid #ccc');\n        this.$voteImageWrapper.css('border-top', 'none');\n    }\n\n    this.getTextDatePicker = function () {\n        this.$pickDate.data('isHasDate', true);\n        var textInput = typeof this.addText() === 'undefined' ? '' : this.addText().trim();\n        if (this._isValidDate(textInput)) {\n            textInput = '';\n        }\n\n        this.$datePicker.data('preText', textInput);\n        this.$datePicker.datetimepicker({\n            showClose: true,\n            icons: {close: 'glyphicon glyphicon-ok'},\n            format: 'DD-MM-YYYY HH:mm',\n        }).data('DateTimePicker').show();\n    }\n\n    this.addTextDate = function (e) {\n        var dateChoosed = moment(e.date).format('DD-MM-YYYY HH:mm');\n        var preText = this.$datePicker.data('preText');\n        var fullText = (preText + ' ' + dateChoosed).trim();\n\n        this.$inputTextOption.val(fullText);\n\n        // Destroy event datepicker that convert text input\n        this.$datePicker.data('DateTimePicker').hide().destroy();\n        this.$pickDate.data('isHasDate', false);\n    }\n\n    this.readURL = function () {\n        var input = this.$inputFileImg[0];\n        var isImage = this._checkExtensionImage(input);\n        var lengthInput = this.$inputTextOption.val();\n\n        if (!this._validateDuplicate(lengthInput)) {\n            if (isImage) {\n                this.$showError.hide();\n\n                if (input.files && input.files[0]) {\n                    var reader = new FileReader();\n                    reader.onload = this._renderImage.bind(this);\n\n                    reader.readAsDataURL(input.files[0]);\n                }\n            } else {\n                this.$inputFileImg.val('');\n                this._displayError(this.messageValidate.image);\n            }\n        }\n    }\n\n    this.deletePhoto = function () {\n        this.$preview.attr('src', '').hide();\n        this.$parentThumb.hide();\n        this.$deleteImg.hide();\n        this.$voteImageWrapper.css('border', 'none');\n        if (this.$inputTextOption.val() == '') {\n            this._notViewSubmit();\n        }\n    }\n\n    this.addText = function () {\n        var lengthInput = this.$inputTextOption.val().trim();\n\n        if (!this._validateDuplicate(lengthInput)) {\n            this.$showError.hide();\n            if (this.isRadio) {\n                $('input[id^=horizontal]')\n                    .add('input[id^=vertical]')\n                    .add('input[id^=timeline]')\n                    .add('input[id^=timeline-temp]')\n                    .prop('checked', false);\n            }\n\n            if (lengthInput == '' && !this.$pickDate.data('isHasDate')) {\n                this._notViewSubmit();\n\n                return;\n            }\n\n            this._viewSubmit();\n\n            return lengthInput;\n        } else {\n            this._notViewSubmit();\n            this._displayError(this.messageValidate.option_duplicate);\n        }\n    }\n\n    this.chooseOption = function (e) {\n        var lengthInput = this.$inputTextOption.val();\n\n        if (lengthInput == '') {\n            if (this.isRadio) {\n                this.$btnVote.prop('disabled', true);\n                this.$newOption.prop('checked', false);\n            }\n\n            this.deletePhoto();\n        }\n\n        if (this.isRadio) {\n            $('input[id^=horizontal]').prop('checked', false);\n        } else {\n            //is checkbox\n            if (!this.$newOption.prop('checked') && !$('input[id^=horizontal]').is(':checked')) {\n                this.$btnVote.prop('disabled', true);\n\n                return;\n            }\n\n            this.$btnVote.prop('disabled', false);\n        }\n    }\n\n    this.chooseOptionWithLi = function () {\n        if (this.isRadio) {\n            this.$newOption.prop('checked', false);\n            this.$inputTextOption.val('')\n            this.deletePhoto();\n        }\n\n        this.$btnVote.prop('disabled', !($('input[id^=horizontal]').is(':checked')));\n        if (this.$newOption.is(':checked')) {\n            this.$btnVote.prop('disabled', false);\n        }\n    }\n\n    this._viewSubmit = function () {\n        this.$newOption.prop('checked', true);\n        this.$btnVote.prop('disabled', false);\n    }\n\n    this._notViewSubmit = function () {\n        if (!$('input[id^=horizontal]').is(':checked')) {\n            this.$btnVote.prop('disabled', true);\n        }\n\n        this.$newOption.prop('checked', false);\n    }\n\n    this._renderImage = function (e) {\n        if (this.isRadio) {\n            $('input[id^=horizontal]').prop('checked', false);\n        }\n\n        this.$preview.attr('src', e.target.result).show();\n        this.$deleteImg.show();\n        this.$voteImageWrapper.css('border', '1px solid #ccc');\n        this.$voteImageWrapper.css('border-top', 'none');\n        this._viewSubmit();\n        this._toScrollLast();\n    }\n\n    this._checkExtensionImage = function (input) {\n        var fileUploadPath = input.value;\n        var extension = fileUploadPath.substring(fileUploadPath.lastIndexOf('.') + 1).toLowerCase();\n        var ruleExtension = ['gif', 'png', 'bmp', 'jpeg', 'jpg'];\n\n        if (ruleExtension.indexOf(extension) > -1) {\n            return true;\n        }\n\n        return false;\n    }\n\n    this._validateDuplicate = function (text) {\n        var isDuplicate = false;\n        this.$contentOption.each(function () {\n            if (text == $(this).text()) {\n                return isDuplicate = true;\n            }\n        });\n\n        return isDuplicate;\n    }\n\n    this._toScrollLast = function () {\n        var scrollHeight = $('.horizontal-overflow').prop(\"scrollHeight\");\n        if (scrollHeight > 400) {\n            this.$horizontalWrapper.animate({\n                    scrollTop: scrollHeight\n            }, 1000);\n        }\n    }\n\n    this._displayError = function (message) {\n        this.$showError.find('.help-block').text(message);\n        this.$showError.show();\n        this._toScrollLast();\n    }\n\n    this._isValidDate = function (dateString) {\n        var regEx = /^(0[1-9]|[1-2][0-9]|3[0-1])-(0[1-9]|1[0-2])-[0-9]{4}\\s+([01]?[0-9]|2[0-3]):[0-5][0-9]$/;\n        return dateString.match(regEx) != null;\n    }\n}\n\n/**\n * Init plugin add image for option\n */\nvar jqAddNewImageOption = new jqAddImageOption({\n    wrapperPoll: '.box-style-option',\n    btnChooseImage: '.upload-photo',\n    parentOption: '.parent-vote-new-option',\n    messages: 'div[data-message]',\n    frImage: \"#frame-upload-image\",\n    frUploadFile: '.photo-tb-upload',\n    frPreImage: '.img-pre-option',\n    frAddImgLink: '.add-image-by-link',\n    frInputText: '.photo-tb-url-txt',\n    frDelPhoto: '.photo-tb-del',\n    frConfirmYes: '.btn-yes',\n    frInputFileTemp: '.fileImgTemp',\n    frContentError : '.error-win-img',\n    messages: 'div[data-option]',\n    horizontalWrapper: '.horizontal-overflow',\n});\n\nvar addOption = new addNewOption();\naddOption.init();\n"]}